!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.typish=e()}(this,(function(){var t=e;function e(n,i){if(!(this instanceof e))return new t(n,i);if("string"==typeof n&&(n=document.querySelector(n)),n&&n[0]&&n[0].nodeName&&(n=n[0]),!n)throw new Error("Unknown element");this.el=n,this.stack=[],this.last=null,this._speed=e.defaultSpeed,this.length=0,this.iterations=0,this.classNames={typing:"-typish-typing",waiting:"-typish-waiting"},this.clearAllSync()}return e.defaultSpeed=50,e.prototype.type=function(t,e,s){var r;"number"==typeof e&&(s=e,e=void 0);for(var l=this,h=0,a=(r=0===s?[t]:t.split("")).length;h<a;h++){!function(t,r){l.queue((function(h){0===r&&(i(l.el,l.classNames.typing),l.spanSync(e)),l.typeSync(t),r===a-1&&n(l.el,l.classNames.typing),l.defer(h,s)}))}(r[h],h)}return this},e.prototype.del=function(t,e){void 0===t&&(t=1);for(var n=0;n<t;n++)this.queue((function(t){this.delSync(),this.defer(t,e)}));return this},e.prototype.wait=function(t){return this.queue((function(e){i(this.el,this.classNames.waiting),this.defer((function(){n(this.el,this.classNames.waiting),e()}),t)}))},e.prototype.clear=function(t){var e=this;return 0===t?this.queue((function(t){this.clearAllSync(),t()})):this.queue((function(n){!function i(){if(0===e.length)return n();e.delSync(),e.defer(i,t)}()}))},e.prototype.then=function(t){return this.queue((function(e){t.apply(this),e()}))},e.prototype.speed=function(t){return this.then((function(){return this._speed=t,this}))},e.prototype.queue=function(t){var e=this,n=this.stack;return n.push(t),1===n.length&&(this.iterations++,t.call(e,(function t(){n.shift(),n.length&&(n[0].call(e,t),e.iterations++)}))),this},e.prototype.defer=function(t,e){if(0===e)return t.call(this),this;"number"==typeof e?e*=this._speed:e=this._speed;var n=this;return setTimeout((function(){t.call(n)}),e),this},e.prototype.spanSync=function(t){var e;if(t&&"<"===t.substr(0,1)){var n=document.createElement("div");n.innerHTML=t,(e=n.children[0])||(e=document.createElement("span"))}else e=document.createElement("span"),t&&(e.className=t.replace(/\./," "));return this.el.appendChild(e),this.last=e,this},e.prototype.typeSync=function(t,e){return e?this.spanSync(e):this.last||this.spanSync(),this.length+=t.length,t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>"),this.last.innerHTML+=t,this},e.prototype.delSync=function(){if(!this.last)return this;this.length--;var t=this.last.innerHTML;return 1===t.length?this.popSpanSync():(this.last.innerHTML=t.substr(t,t.length-1),0===t.length?this.popSpanSync():this)},e.prototype.popSpanSync=function(){return this.last?(this.el.removeChild(this.last),this.el.children.length?this.last=this.el.children[this.el.children.length-1]:this.last=void 0,this):this},e.prototype.clearAllSync=function(){this.el.innerHTML="",this.length=0},e;function n(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(n," ").replace(/(^\s*)|(\s*$)/g,"").replace(/\s{2,}/g," ")}}function i(t,e){t.classList?t.classList.add(e):t.className=(t.className+" "+e).replace(/(^\s*)|(\s*$)/g,"").replace(/\s{2,}/g," ")}}));